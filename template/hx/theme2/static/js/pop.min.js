var studioMbPerson={load:function(o,i){o&&o.isLogin&&(this.refreshNickname(o.nickname),$("#person_hp").attr("src",studioMbPerson.getUserLevelIco(o.clientGroup,o.avatar)),$("#upg_tbody_id").html(""),studioMbPop.loadingBlock($("#upg_tbody_id")),$.getJSON("/hxstudio/getClientGroupList",null,function(i){if(studioMbPop.loadingBlock($("#upg_tbody_id"),!0),i){var e="",t=0,n=null;for(var s in i)i[s].clientGroupId==o.clientGroup&&(t=i[s].sequence);var r,u=[];for(var l in i)n=i[l],r="",n.clientGroupId==o.clientGroup?(r=' class="on"',e="当前级别"):e="visitor"!=n.clientGroupId&&t<n.sequence?"vip"==n.clientGroupId?"联系客服升级":'<a href="javascript:void(0)" t="'+n.clientGroupId+'">升级</a>':"---",u.push("<tr"+r+'><td width="17%"><img src="'+studioMbPerson.getUserLevelIco(n.clientGroupId)+'"></td>'),u.push('<td width="20%"><b>'+common.trim(n.remark)+"</b></td>"),u.push('<td width="43%">'+common.trim(n.authorityDes)+"</td>"),u.push('<td width="20%">'+e+"</td></tr>");$("#upg_tbody_id").append(u.join("")),$("#upg_tbody_id a").click(function(){var o=$(this).attr("t");studioMbPop.loadingBlock($("#personPop")),common.getJson("/hxstudio/upgrade",{clientGroup:o},function(i){if(studioMbPop.loadingBlock($("#personPop"),!0),i.isOK){var e="升级成功！刷新页面后，您可享用更多直播间权限。";"active"===i.clientGroup&&"notActive"===o&&(e+="<br/>注：你已经激活真实交易账户，直接为你升级到A级别。"),studioMbPop.popBox("msg",{msg:e,type:"upg"})}else"active"===o?studioMbPop.showMessage("很遗憾，您未激活恒信真实交易账户，升级失败！如有疑问请联系客服！"):"notActive"===o?studioMbPop.showMessage("很遗憾，您未开通恒信真实交易账户，升级失败！如有疑问请联系客服！"):"simulate"===o&&studioMbPop.showMessage("很遗憾，您未开通恒信模拟交易账户，升级失败！如有疑问请联系客服！")},!0,function(){studioMbPop.loadingBlock($("#personPop"),!0)})})}}),$(".logoutbtn").bind("click",i,function(o){LoginAuto.setAutoLogin(!1),window.location.href="/hxstudio/logout?platform="+o.data}))},init:function(){},getUserLevelIco:function(o,i){if(common.isValid(i))return i;var e="/hx/theme2/img/user_c.png";switch(o){case"vip":e="/hx/theme2/img/user_v.png";break;case"active":e="/hx/theme2/img/user_r.png";break;case"notActive":e="/hx/theme2/img/user_r.png";break;case"simulate":e="/hx/theme2/img/user_d.png";break;case"register":e="/hx/theme2/img/user_m.png"}return e},refreshNickname:function(o){$("#person_nn").html(o)}},studioMbLogin={verifyCodeIntervalId:0,groupId:null,clientStoreId:null,clientGroup:null,load:function(){this.setEvent()},init:function(o,i,e,t,n,s){this.groupId=i,this.clientStoreId=e,this.clientGroup=t,this.resetFormInput(),$("#loginForm_csi").val(e),n?$("#loginPop .pop-close").show():$("#loginPop .pop-close").hide(),s?$("#login_tip").show().text($("#setlogintip").text()):$("#login_tip").hide(),"wechat"==o&&$("#loginForm .auto_login").hide()},setEvent:function(){$("#verMalCodeId").click(function(){$("#verMalCodeId img").attr("src","/hxstudio/getVerifyCode?code=acLogin&t="+(new Date).getTime())}),$(".login-mode li").click(function(){$(this).addClass("on").siblings().removeClass("on"),$(".mform .lg-box").hide().eq($(this).index()).show(),1==$(this).index()&&$("#verMalCodeId").click()}),$("#loginForm_sub").bind("click",function(){var o=$("#loginForm .login-inf").is(":visible");studioMbLogin.checkFormInput("#loginForm",o?["mobilePhone","verifyCode"]:["accountNo","pwd","verMalCode"])&&(studioMbPop.loadingBlock($("#loginPop")),common.getJson("/hxstudio/hxLogin",$("#loginForm").serialize()+"&isPwdLogin="+o,function(o){return o.isOK?(studioMbLogin.clientGroup=o.userInfo.clientGroup,void(studioMbLogin.groupId?common.getJson("/hxstudio/checkGroupAuth",{redirectDef:1},function(o){o.isOK?(studioMbPop.loadingBlock($("#loginPop"),!0),studioMbLogin.groupId==o.groupId?studioMbPop.reload():window.setTimeout(function(){studioMbPop.reload()},2200)):o.error&&"1000"===o.error.errcode&&studioMbPop.showMessage("您长时间未操作，请刷新页面后重试！")},!0,function(o){studioMbPop.loadingBlock($("#loginPop"),!0),"success"!=o&&studioMbPop.showMessage("操作失败，请联系客服！")}):(studioMbPop.loadingBlock($("#loginPop"),!0),LoginAuto.setAutoLogin($("#loginForm_al").prop("checked")),studioMbPop.reload()))):(studioMbPop.loadingBlock($("#loginPop"),!0),studioMbPop.showMessage(o.error.errmsg),!1)},!0,function(){studioMbLogin.resetFormInput(),studioMbPop.loadingBlock($("#loginPop"),!0)}))}),$("#loginForm_mb").bind("input propertychange",function(){var o=$("#loginForm_vcb");parseInt(o.attr("t"))<60&&0==o.is(".pressed")||(common.isMobilePhone(this.value)?o.addClass("pressed"):o.removeClass("pressed"))}),$("#loginForm_vcb").bind("click",function(){if($("#loginForm_vc").blur(),$(this).hasClass("pressed")){$(this).removeClass("pressed").val("发送中...");var o=$("#loginForm_mb").val();try{$.getJSON("/hxstudio/getMobileVerifyCode?t="+(new Date).getTime(),{mobilePhone:o,useType:"hxstudio_login"},function(o){o&&0==o.result?studioMbLogin.setVerifyCodeTime():("1005"==o.errcode?studioMbPop.showMessage(o.errmsg):console.error("提取数据有误！"),studioMbLogin.resetVerifyCode())})}catch(i){studioMbLogin.resetVerifyCode(),console.error("getMobileVerifyCode->"+i)}}})},resetFormInput:function(){$("#loginForm_mb").val("").trigger("input"),$("#loginForm_vc").val("")},checkFormInput:function(o,i){var e=!0,t="",n=" input[type!=checkbox]";if(i)for(var s in i)n+="[name!="+i[s]+"]";return $(o+n).each(function(){return common.isBlank($(this).val())?("accountNo"==this.name&&(e=!1,t="账号不能为空！"),"pwd"==this.name&&(e=!1,t="密码不能为空！"),"verMalCode"==this.name&&(e=!1,t="验证码不能为空！"),"mobilePhone"==this.name&&(e=!1,t="手机号码不能为空！"),"verifyCode"==this.name&&(e=!1,t="验证码不能为空！"),"nickname"==this.name&&(e=!1,t="昵称不能为空！"),studioMbPop.showMessage(t),e):"mobilePhone"!=this.name||($(this).val($.trim($(this).val())),common.isMobilePhone(this.value))?"nickname"!=this.name||common.isRightName(this.value)?void("verMalCode"==this.name&&$(this).val(this.value.toLowerCase())):(e=!1,t="昵称为2至10位字符(数字/英文/中文/下划线)，不能全数字!",studioMbPop.showMessage(t),e):(e=!1,t="手机号码输入有误！",studioMbPop.showMessage(t),e)}),e||$error.show(),e},resetVerifyCode:function(){studioMbLogin.verifyCodeIntervalId&&(clearInterval(studioMbLogin.verifyCodeIntervalId),studioMbLogin.verifyCodeIntervalId=null),$("#loginForm_vcb").attr("t",60).val("获取验证码"),$("#loginForm_mb").trigger("input")},setVerifyCodeTime:function(){var o=$("#loginForm_vcb"),i=parseInt(o.attr("t"))||60;studioMbLogin.verifyCodeIntervalId||(studioMbLogin.verifyCodeIntervalId=window.setInterval(studioMbLogin.setVerifyCodeTime,1e3)),i>1?o.attr("t",i-1).val("重新获取("+(i-1)+")"):studioMbLogin.resetVerifyCode()},checkClientGroup:function(o){var i=!1;switch(o){case"visitor":i="visitor"==this.clientGroup;break;case"vip":i="vip"==this.clientGroup||"active"==this.clientGroup;break;case"new":i="vip"!=this.clientGroup&&"active"!=this.clientGroup}return i},forceLogin:function(o){var i=LoginAuto.get();return"boolean"!=typeof o?i&&1==i.forceLogin:i?(i.forceLogin=o,LoginAuto.set(i)&&o):!1}},studioMbMsg={type:null,load:function(){$("#resultForm_sub").bind("click",function(){"logout"==studioMbMsg.type?studioMbPop.reload():studioMbPop.popHide()})},init:function(o,i){this.type=o,$("#resultForm_msg").html(i),"logout"==studioMbMsg.type?($("#resultPop .pop-close, #resultForm i").hide(),$("#resultForm_sub").val("重新登录")):($("#resultPop .pop-close, #resultForm i").show(),$("#resultForm_sub").val("确认"))}},studioMbSet={studioChatObj:null,load:function(){this.setEvent()},init:function(o){this.studioChatObj=o,$("#setForm").trigger("reset")},setEvent:function(){$("#setForm_sub").bind("click",function(){studioMbSet.checkFormInput()&&(studioMbPop.loadingBlock($("#setPop")),common.getJson("/hxstudio/modifyName",$("#setForm").serialize(),function(o){return studioMbPop.loadingBlock($("#setPop"),!0),o.isOK?($("#pmInfoSetBox .pop_close").trigger("click"),studioMbSet.studioChatObj.refreshNickname(!0,o.nickname),$("#sendBtn").trigger("click"),void 0):(studioMbPop.showMessage(o.msg?o.msg:"修改失败，请联系客服！"),!1)},!0,function(){studioMbPop.loadingBlock($("#setPop"),!0)}))})},checkFormInput:function(){var o=!0,i="",e=$("#setForm_nn").val();return common.isBlank(e)?(o=!1,i="昵称不能为空！"):common.isRightName(e)||(o=!1,i="昵称为2至10位字符(数字、英文、中文、下划线),不能全是数字"),studioMbPop.showMessage(i),o}},studioMbPop={Person:studioMbPerson,Login:studioMbLogin,Set:studioMbSet,Msg:studioMbMsg,onShow:null,onHide:null,showMessage:function(o){if(o){var i=$(".errorbox");i.hide().find("div").html(o),i.fadeIn().delay(2e3).fadeOut(200)}},loadingBlock:function(o,i){i?o.children("div.img-loading").remove():o.append('<div class="img-loading"><i></i></div>')},popShow:function(o){$(".popupbg").is(":hidden")&&$(".popupbg").fadeIn(),$(".popupbox").hide(),this.onShow&&this.onShow.call(null),o.show()},popHide:function(){$(".popupbox").hide(),this.onHide&&this.onHide.call(null),$(".popupbg").fadeOut()},reload:function(){var o=window.location.href;o=-1==o.indexOf("?")?o+"?t="+(new Date).getTime():-1==o.indexOf("t=")?o+"&t="+(new Date).getTime():o.replace(/t=\d*/,"t="+(new Date).getTime()),window.location.href=o},load:function(o,i,e){e&&(this.onShow="function"==typeof e.onShow?e.onShow:null,this.onHide="function"==typeof e.onHide?e.onHide:null),this.Person.load(o,i),this.Login.load(),this.Set.load(),this.Msg.load(),$(".pop-close").click(function(){studioMbPop.popHide()})},popBox:function(o,i){switch(o){case"person":this.popShow($("#personPop")),this.Person.init();break;case"login":this.popShow($("#loginPop")),this.Login.init(i.platform,i.groupId,i.clientStoreId,i.clientGroup,i.closeable!==!1,i.showTip);break;case"set":this.popShow($("#setPop")),this.Set.init(i.studioChatObj);break;case"msg":this.popShow($("#resultPop")),this.Msg.init(i.type,i.msg)}},openCSBox:function(){window.open("https://www.serve888.com/serve888/chatClient/chatbox.jsp?companyID=217&s=1","Live800Chatindow","height=520,width=740,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no")},studioGA:function(o,i,e,t,n,s){"function"==typeof ga&&"object"==typeof _trackData&&_trackData instanceof Array&&(ga(o,i,e,t,n),_trackData.push(s))}};