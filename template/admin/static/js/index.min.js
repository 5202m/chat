var index={currNwWin:null,winOpenObj:[],isNw:!1,init:function(){this.setEvent()},setEvent:function(){this.joinRoom(),$(".lst_p .rm_p label").click(function(){$(this).next(".rm_list").is(":hidden")?($(this).next(".rm_list").show(),$(this).parent().addClass("on")):($(this).parent().removeClass("on"),$(this).next(".rm_list").hide())}),$("#logBtnSub").click(function(){index.login()}),$("#loginForm input").keydown(function(n){13==n.keyCode&&index.login()}),$(".mod_left1 .title a").click(function(){index.logout()})},login:function(){var n=$.trim($('#loginForm input[name="userId"]').val()),i=$.trim($('#loginForm input[name="password"]').val());common.isBlank(n)?$("#loginForm .error").text("请输入用户名"):common.isBlank(i)?$("#loginForm .error").text("请输入登录密码"):($("#loginForm .error").text(""),common.getJson("/admin/login",{userId:n,password:i},function(n){n.isOK?location.reload():$("#loginForm .error").text(n.msg)}))},joinRoom:function(){$(".lst_p .rm_p .rm_list li").click(function(){$(".lst_p .rm_p .rm_list li").removeClass("on"),$(this).addClass("on");var n=$(this).attr("r"),i=$(this).attr("t"),o=$(this).parent().prev().text(),e=$(this).children("span").text(),t="/admin/room?groupId="+n+"&groupType="+i+"&roomName="+o+"【"+e+"】";index.isNw&&(t+="&nw="+index.isNw);var r=window.open(t,n,"location=no,resizable=yes");index.winOpenObj.push(r)})},logout:function(){var n="/admin/logout";index.isNw&&(n+="?nw="+index.isNw),$.getJSON(n,null,function(n){n.isOK&&(n.isNw?index.closeOpenWin(!0):(index.closeOpenWin(!1),location.reload()))})},closeOpenWin:function(n){if(n&&(index.currNwWin.removeAllListeners("close"),index.currNwWin.close()),index.winOpenObj!=[])for(var i=index.winOpenObj.length,o=0;o<i;o++)index.winOpenObj[o].close()}};$(function(){index.init()});