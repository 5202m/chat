function UUID(){this.id=this.createUUID()}function openLive800Chat(t){var e="https://www.onlineservice-hk.com/k800/chatClient/chatbox.jsp?companyID=209&s=1";t?location.href=e:window.open(e,"Live800Chatindow","height=520,width=740,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no")}function openQQChatByCommonv3(t,e){common.isBlank(e)&&(e="800018282");var n="http://crm2.qq.com/page/portalpage/wpa.php?uin="+e+"&cref=&ref=&f=1&ty=1&ap=&as="+t;window.open(n,"QQChatindow","height=544, width=644,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no")}function openQQChatByCommonjs(){var t="http://wpa.b.qq.com/cgi/wpa.php?ln=2&uin=800018282";window.open(t)}function live800Prompt(t){window.onbeforeunload=null;var e="http://wpa.b.qq.com/cgi/wpa.php?ln=2&uin=800018886",n="http://onlinecustomer-service.gwghk.com/live800/chatClient/chatbox.jsp?companyID=283&enterurl=http%3A%2F%2Fwww%2Egwfx%2Ecom%2F&tm=1355377642406";if(2==t)try{UUID.prototype.createUUID();window.open(e,"Live800Chatindow","height=520,width=740,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no")}catch(o){window.open(e,"Live800Chatindow","height=520,width=740,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no")}else try{UUID.prototype.createUUID();window.open(n,"Live800Chatindow","height=520,width=740,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no")}catch(o){window.open(n)}}function qqPrompt(t){var e="http://wpa.b.qq.com/cgi/wpa.php?ln=2&uin=800018886";window.onbeforeunload=null;try{var n=UUID.prototype.createUUID();getGacookiesTrack(n,"2","1"),window.open(e,"Live800Chatindow","height=520,width=740,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no")}catch(o){window.open(e,"Live800Chatindow","height=520,width=740,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no")}}var _gaq=_gaq||[],_hmt=_hmt||[];UUID.prototype.valueOf=function(){return this.id},UUID.prototype.toString=function(){return this.id},UUID.prototype.createUUID=function(t){var e=new Date(1582,10,15,0,0,0,0),n=new Date,o=n.getTime()-e.getTime(),i=UUID.getIntegerBits(o,0,31),s=UUID.getIntegerBits(o,32,47),r=UUID.getIntegerBits(o,48,59)+"1",a=UUID.getIntegerBits(UUID.rand(4095),0,7),u=UUID.getIntegerBits(UUID.rand(4095),0,7),l=UUID.getIntegerBits(UUID.rand(8191),0,7)+UUID.getIntegerBits(UUID.rand(8191),8,15)+UUID.getIntegerBits(UUID.rand(8191),0,7)+UUID.getIntegerBits(UUID.rand(8191),8,15)+UUID.getIntegerBits(UUID.rand(8191),0,15);return(t||"")+i+s+r+a+u+l},UUID.getIntegerBits=function(t,e,n){var o=UUID.returnBase(t,16),i=new Array,s="",r=0;for(r=0;r<o.length;r++)i.push(o.substring(r,r+1));for(r=Math.floor(e/4);r<=Math.floor(n/4);r++)s+=i[r]&&""!=i[r]?i[r]:"0";return s},UUID.returnBase=function(t,e){return t.toString(e).toUpperCase()},UUID.rand=function(t){return Math.floor(Math.random()*(t+1))};var chatAnalyze={localHref:window.location.href,utmStore:{ip:"",storeKey:"GWAFLGPHONECOOIKETRACK",userId:"",roomId:"",groupType:"",speakCount:0,onlineSTM:(new Date).getTime(),onlineETM:0},isLocalHref:function(){return/^https?:\/\/(\d{1,3}\.){3}\d{1,3}.+/.test(chatAnalyze.localHref)},init:function(){if(!this.isLocalHref()){var t="";-1!=chatAnalyze.localHref.indexOf("/studio")?t="studio":-1!=chatAnalyze.localHref.indexOf("/fxstudio")?t="fxstudio":-1!=chatAnalyze.localHref.indexOf("/hxstudio")&&(t="hxstudio"),""!=t&&(this.initGA(t),this.setGA(),this.setBaidu(),window.setTimeout(chatAnalyze.sendUTM(),1e4))}},initGA:function(t){"studio"==t&&(_gaq.push(["_setAccount","UA-31478987-1"]),_gaq.push(["_setDomainName","24k.hk"]),_gaq.push(["_addIgnoredRef","24k.hk"])),"fxstudio"==t&&(_gaq.push(["_setAccount","UA-49389835-1"]),_gaq.push(["_setDomainName","gwfx.com"]),_gaq.push(["_addIgnoredRef","gwfx.com"])),"hxstudio"==t&&(_gaq.push(["_setAccount",""]),_gaq.push(["_setDomainName","handan.hx9999"]),_gaq.push(["_addIgnoredRef","handan.hx9999"])),_gaq.push(["_setAllowLinker",!0]),_gaq.push(["_addOrganic","soso","w"]),_gaq.push(["_addOrganic","sogou","query"]),_gaq.push(["_addOrganic","youdao","q"]),_gaq.push(["_addOrganic","baidu","word"]),_gaq.push(["_addOrganic","baidu","q1"]),_gaq.push(["_addOrganic","ucweb","keyword"]),_gaq.push(["_addOrganic","ucweb","word"]),_gaq.push(["_addOrganic","114so","kw"]),_gaq.push(["_addOrganic","360","q"]),_gaq.push(["_addOrganic","so","q"]),_gaq.push(["_trackPageview"])},setGA:function(){try{var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}catch(n){console.log("Set GA fail!"+n)}},setBaidu:function(){try{var t=document.createElement("script");t.src="//hm.baidu.com/hm.js?52a2828b884f1a2ba8a3e25efe98eb65";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}catch(n){console.log("Set GA fail!"+n)}},getIp:function(t){$.getJSON("http://chaxun.1616.net/s.php?type=ip&output=json&callback=?&_="+Math.random(),function(e){chatAnalyze.utmStore.ip=e.Ip,t&&t()})},getUTMCookie:function(){for(var t=document.cookie,e=t.split(/[;&]/),n=0;n<e.length;n++){var o=e[n].split("=");if($.trim(o[0])==this.utmStore.storeKey)return o[1]}var i="127.0.0.1";-1!=chatAnalyze.localHref.indexOf("/studio")?i=".24k.hk":-1!=chatAnalyze.localHref.indexOf("/fxstudio")&&(i=".gwfx.com");var s=UUID.prototype.createUUID(-1!=i.indexOf("gwfx")?"":"G");return document.cookie=this.utmStore.storeKey+"="+escape(s)+"; expires=Tue, 31 Dec 2030 00:00:00 UTC; path=/;domain="+i,s},setUTM:function(t,e){try{this.getIp(),t?(this.utmStore.roomId=e.groupId,this.utmStore.userId=e.userId,this.utmStore.userTel=e.userTel,this.utmStore.clientGroup=e.clientGroup,this.utmStore.groupType=e.groupType,$(window).unload(function(){chatAnalyze.utmStore.onlineETM=(new Date).getTime(),chatAnalyze.sendUTM(null),window.event.returnValue=!0})):e.speakCount?this.utmStore.speakCount+=e.speakCount:chatAnalyze.utmStore.ip?chatAnalyze.sendUTM(e):this.getIp(function(){chatAnalyze.sendUTM(e)})}catch(n){console.log("Set UTM fail!"+n)}},utmAjax:function(t,e,n){$.ajax({async:n,url:t+"?t="+(new Date).getTime(),cache:!1,dataType:n?"jsonp":"json",data:{data:JSON.stringify(e)},success:function(t){}})},sendUTM:function(t){try{if(!store.enabled)return void console.log("Local storage is not supported by your browser.");var e=chatAnalyze.utmStore;if(!e.roomId||!e.groupType)return;if(!e.userTel&&!e.userId){var n=store.get("storeInfo_"+e.groupType);if(!n)return;e.userId=n.userId}var o=-1!=e.groupType.indexOf("fx")?1:2,i=this.getUTMCookie(),s=this.isLocalHref(),r={userId:i,customerType:e.clientGroup,ip:e.ip,businessPlatform:o,platformType:common.isMobile()?1:0,roomId:e.roomId};e.userTel?r.operationTel=e.userTel:r.visitorId=e.userId;var a=s?"http://testweb.gwfx.com:8088/GwUserTrackingManager_NEW/put/insertChart":"http://das.gwfx.com/put/insertChart";t&&t.courseId?(r.courseId=t.courseId,this.utmAjax(a,r,!0)):(r.startDateTime=e.onlineSTM,r.endDateTime=e.onlineETM,r.speakCount=e.speakCount,navigator.sendBeacon?navigator.sendBeacon(a+"Close",JSON.stringify(r)):this.utmAjax(a,r,!1))}catch(u){console.log("send UTM fail!"+u)}}};$(function(){chatAnalyze.init()});var common={daysCN:{0:"星期天",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},remove:function(t,e){return isNaN(e)||e>t.length?!1:void t.splice(e,1)},joinSplit:function(t){return",".concat(t).concat(",")},isBlank:function(t){return void 0==t||null==t||"undefined"==t||"null"==t||""==$.trim(t)},isValid:function(t){return!this.isBlank(t)},trim:function(t){return this.isBlank(t)?"":t.toString().replace(/(^\s*)|(\s*$)/g,"")},escapeHtml:function(t){return document.createElement("div").appendChild(document.createTextNode(t)).parentNode.innerHTML.replace(/"/g,'\\"')},encodeHtml:function(t){return this.isBlank(t)?"":t.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},formatterDate:function(t,e){e||(e="-"),t instanceof Date||(t=new Date(t));var n=t.getFullYear()+e+(t.getMonth()+1>=10?t.getMonth()+1:"0"+(t.getMonth()+1))+e+(t.getDate()<10?"0"+t.getDate():t.getDate());return n},getHHMMSS:function(t){t instanceof Date||(t=new Date(t));var e=(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds());return e},getMMSS:function(t){return t instanceof Date||(t=new Date(t)),(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())},getHHMM:function(t){t instanceof Date||(t=new Date(t));var e=(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes());return e},formatterDateTime:function(t,e){if(e||(e="-"),t instanceof Date||(t=new Date(t)),"Invalid Date"==t)return"";var n=t.getFullYear()+e+(t.getMonth()+1>=10?t.getMonth()+1:"0"+(t.getMonth()+1))+e+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds());return n},longMsTimeToDateTime:function(t,e){var n=new Date(t);return this.formatterDateTime(n,e)},showBox:function(t,e){$(t).slideDown(),$(e||".layer-shadow").show()},hideBox:function(t,e){$(t).slideUp(),$(e||".layer-shadow").hide()},containSplitStr:function(t,e){return common.isBlank(t)||common.isBlank(e)?!1:-1!=(","+t+",").indexOf(","+e+",")},getJson:function(t,e,n,o,i){var s=null;return $.ajax({url:t,type:"POST",timeout:1e5,cache:!1,async:void 0!=o?o:!1,dataType:"json",data:e,success:"function"==typeof n?n:function(t){s=t},error:function(t,e){"function"==typeof i?i(e):common.isValid(t.responseText)&&"OK"!=t.statusText?alert(t.responseText):alert("请求超时,请重试!")}}),s},arraySort:function(t,e){return function(n,o){return e?n[t]<o[t]:n[t]>o[t]}},randomNumber:function(t){for(var e="",n=0;t>n;n++)e+=Math.floor(10*Math.random());return e},isMobilePhone:function(t){return/(^[0-9]{11})$|(^86(-){0,3}[0-9]{11})$/.test(t)},dateTimeWeekCheck:function(t,e,n){if(this.isBlank(t))return!!e;$.isPlainObject(t)||(t=JSON.parse(t));var o=n?new Date(n):new Date,i=!1,s=this.formatterDate(o);if(i=this.isBlank(t.beginDate)||s>=t.beginDate,i&&(i=this.isBlank(t.endDate)||s<=t.endDate),!i)return!1;var r=t.weekTime;if(this.isBlank(r))return i;var a=null,u=null,l=!1;for(var c in r)if(a=r[c],(!this.isValid(a.week)||o.getDay()==parseInt(a.week))&&(u=this.getHHMMSS(o),l=this.isBlank(a.beginTime)||u>=a.beginTime,l&&(l=this.isBlank(a.endTime)||u<=a.endTime),l))break;return l},arrayUnique:function(t){if(!t)return t;for(var e,n=[],o={},i=0;null!=(e=t[i]);i++)o[e]||(n.push(e),o[e]=!0);return n},isWebSocket:function(){return window.WebSocket},getSocket:function(t,e,n){return common.isWebSocket()?(console.log("used websocket!"),t.connect(e.webSocket+"/"+n,{transports:["websocket"]})):t.connect(e.socketIO+"/"+n)},refreshSession:function(){setInterval(function(){$.get("/refreshSession?t="+new Date,function(){})},9e5)},randomNumber:function(t){for(var e="",n=0;t>n;n++)e+=Math.floor(10*Math.random());return e},clearMsgHtml:function(t){var t=t.replace(/((^((&nbsp;)+))|\n|\t|\r)/g,"").replace(/<\/?(?!(img|IMG)\s+src="[^>"]+\/face\/[^>"]+"\s*>)[^>]*>/g,"");return t&&(t=$.trim(t)),t},formatToJson:function(t){return this.isBlank(t)?null:JSON.parse(t)},getSyllabusPlan:function(t,e,n,o){if(!t||!t.courses)return null;var i=function(t,e){if(t&&3!=e){var i,s=common.isMobile();"object"!=typeof t&&(t=JSON.parse(t));for(var r in t)if(i=t[r],s){if(1==e&&(!n&&3==i.code||n&&4==i.code))return i.url}else if(o){if(1==e&&3==i.code){var a=i.url||"";return a=a.replace(/^http:/,"rtmps:").replace(/\/index\.m3u8$/,"")}}else if(i.code==e)return i.url}return null},s=function(e,n,o){var s=null,r=e.course;return r&&r.length>n?(s=r[n],0==s.status||common.isBlank(s.lecturerId)?null:(s.studioLink=i(t.studioLink,s.courseType),s.startTime=e.startTime,s.endTime=e.endTime,s.day=u[n].day,s.isNext=o,s)):null},r=null;r=this.isValid(t.courses)&&"object"!=typeof t.courses?JSON.parse(t.courses):t.courses;for(var a,u=r.days,l=r.timeBuckets,c=(new Date(e).getDay()+6)%7,d=common.getHHMM(e),p=null,h=null,f=0;f<u.length;f++)if(0!=u[f].status)if(a=(u[f].day+6)%7,a>c){for(var g in l)if(p=l[g],h=s(p,f,!0))return h}else if(a==c)for(var g in l)if(p=l[g],p.startTime<=d&&(p.endTime>=d||"00:00"==p.endTime)?h=s(p,f,!1):p.startTime>d&&(h=s(p,f,!0)),h)return h;if(!t.publishEnd)return null;for(var f=0;f<u.length;f++)if(0!=u[f].status&&(a=(u[f].day+6)%7,!(t.publishEnd<864e5*(a+7-c)+e)))for(var g=0;g<l.length;g++)if(h=s(l[g],f,!0))return h;return null},formatSyllabus:function(t,e,n,o){var i={dayCN:["星期天","星期一","星期二","星期三","星期四","星期五","星期六"],indexCN:["第一节","第二节","第三节","第四节","第五节","第六节","第七节","第八节"],courseCls:["prev","ing","next"],tableCls:"syllabus",courseType:{0:"文字在线",1:"视频在线",2:"ONE TV"}},s=new Date(e).getDay(),r=this.getHHMM(e),a=$.extend({},i,o),u=function(t,e,n,o){var i=0,u=(t+6)%7,l=(s+6)%7;return i=u>l?2:l>u?0:o?1:r>=n?0:e>r?2:1,a.courseCls[i]},l=[];try{if(t){var c=$.isPlainObject(t)?t:JSON.parse(t),d=c.days?c.days.length:0;if(d>0)if(1===n){var p={0:"文字",1:"视频",2:"oneTV"};l.push('<div class="sy_panel">');var h=e-864e5*((s+6)%7),f=null,g=null,m=null;l.push('<div class="sy_nav">');for(var b=' style="width:'+100/d+'%;"',v=0;d>v;v++)f=new Date(h+(c.days[v].day+6)%7*864e5),g=f.getFullYear()+"-"+(f.getMonth()<9?"0":"")+(f.getMonth()+1)+"-"+(f.getDate()<10?"0":"")+f.getDate(),m=c.days[v].day==s?' class="active"':"",l.push('<a href="javascript:void(0)" d="'+c.days[v].day+'"'+m+b+">"+a.dayCN[c.days[v].day]+"<br/><span>"+g+'</span><em class="dir">^</em></a>');l.push("</div>"),l.push('<div class="sy_cont"><div>'),l.push('<table cellpadding="0" cellspacing="0" border="0" class="'+a.tableCls+'">');for(var y=null,I=null,v=0;d>v;v++){if(l.push('<tbody d="'+c.days[v].day+'">'),0==c.days[v].status)I=u(c.days[v].day,null,null,!0),l.push('<tr class="'+I+'" width="100%"><td>休市</td></tr>');else for(var w=0,T=c.timeBuckets.length;T>w;w++)y=c.timeBuckets[w],I=u(c.days[v].day,y.startTime,y.endTime,!1),0==y.course[v].status?(l.push('<tr class="'+I+'">'),l.push('<td width="25%">'+y.startTime+"-"+y.endTime+"</td>"),l.push('<td colspan="2" width="75%">休市</td>'),l.push("</tr>")):y.course[v].lecturer&&(l.push('<tr class="'+I+'">'),l.push('<td width="25%">'+y.startTime+"-"+y.endTime+"【"+p[y.course[v].courseType]+"】</td>"),l.push('<td width="25%">'+y.course[v].lecturer+"</td>"),l.push('<td width="50%">'+y.course[v].title+"</td>"),l.push("</tr>"));l.push("</tbody>")}l.push("</table>"),l.push("</div></div>"),l.push("</div>")}else if(2===n){l.push('<table cellpadding="0" cellspacing="1" border="0" class="'+a.tableCls+'">'),l.push("<tr>"),l.push("<th>星期\\节次</th>");for(var T=c.timeBuckets?c.timeBuckets.length:0,y=null,I=null,w=0;T>w;w++)y=c.timeBuckets[w],l.push("<th>"+a.indexCN[w]+"<br><span>("+y.startTime+"-"+y.endTime+")</span></th>");l.push("</tr>");for(var k=null,v=0,M=c.days?c.days.length:0;M>v;v++){if(k=c.days[v],l.push("<tr>"),l.push("<th>"+a.dayCN[k.day]+"</th>"),0==k.status)I=u(k.day,null,null,!0),l.push('<td class="'+I+'" colspan="'+T+'">休市</td>');else for(var w=0;T>w;w++)y=c.timeBuckets[w],I=u(k.day,y.startTime,y.endTime,!1),l.push('<td class="'+I+'">'+(0==y.course[v].status?"休市":y.course[v].lecturer)+"</td>");l.push("</tr>")}l.push("</table>")}else if(3===n){var h=r-864e5*((s+6)%7),f=null,m=null,k=null,b=' style="width:'+100/d+'%;"';l.push("<tr>");for(var v=0;d>v;v++)k=c.days[v],f=new Date(h+(c.days[v].day+6)%7*864e5),m=c.days[v].day==s?' class="active"':"",l.push('<th d="'+c.days[v].day+'"'+m+b+">"+a.dayCN[c.days[v].day]+"<i></i></th>");l.push("</tr>"),l.push('<tr><td class="space" colspan="'+d+'"></td></tr>');for(var y=null,I=null,v=0;d>v;v++){if(k=c.days[v],l.push('<tr d="'+k.day+'"><td colspan="'+d+'">'),0==k.status)I=u(k.day,null,null,!0),l.push('<p class="'+I+'">休市</p>');else for(var w=0,T=c.timeBuckets?c.timeBuckets.length:0;T>w;w++)y=c.timeBuckets[w],y.course[v].lecturer&&(I=u(k.day,y.startTime,y.endTime,!1),l.push('<p class="'+I+'">'),l.push("<span>"+y.startTime+"-"+y.endTime+"</span>"),0==y.course[v].status?l.push("<span>休市</span>"):(l.push("<span>"+a.courseType[y.course[v].courseType]+"</span>"),l.push("<span>"+y.course[v].lecturer+"</span>"),l.push('<span class="item">'+y.course[v].title+"</span>")),l.push("</p>"));l.push("</td></tr>")}}}}catch(x){return console.error("formatSyllabus->"+x),""}return l.join("")},isMobile:function(){return/(iphone|ipod|ipad|android|mobile|playbook|bb10|meego)/.test(navigator.userAgent.toLowerCase())},isHTTPS:function(){return/^https:\/\//.test(location.href)},copyObject:function(t,e,n){if(!e)return t;for(var o in t)e.hasOwnProperty(o)&&common.isValid(e[o])&&(t[o]=e[o]);if(n)for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])},isRightName:function(t){return!/^([0-9]{2,20})$/g.test(t)&&/^([\w\u4e00-\u9fa5]{2,20})$/g.test(t)},randomIndex:function(t){var e=parseInt(Math.round(Math.random()*t));return e==t&&(e=t-1),0>e?0:e},saveToDesktop:function(t,e){try{var n=new ActiveXObject("WScript.Shell"),o=n.CreateShortcut(n.SpecialFolders("Desktop")+"\\"+e+".url");o.TargetPath=t,o.Save()}catch(i){return!1}return!0},getUrlParam:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(e);return null!=n?unescape(n[2]):null},keysrt:function(t,e){return function(n,o){return e?~~(n[t]<o[t]):~~(n[t]>o[t])}}};window.console||(console=function(){function t(){}function e(){return null==n&&(n=new t),n}var n=null;return t.prototype={log:function(t){},error:function(t){}},e()}()),$.fn.focusEnd=function(){$(this).focus();var t=$("<span/>").appendTo($(this)),e=t.get(0),n=null,o=null;return document.selection?(n=document.body.createTextRange(),n.moveToElementText(e),n.select()):window.getSelection&&(n=document.createRange(),n.selectNode(e),o=window.getSelection(),o.removeAllRanges(),o.addRange(n)),t.remove(),this},String.prototype.formatStr=function(){if(0==arguments.length)return this;for(var t=this,e=0;e<arguments.length;e++)t=t.replace(new RegExp("\\{"+e+"\\}","g"),null==arguments[e]||void 0==arguments[e]?"":arguments[e]);return t};var studioChatMbIdx={options:null,userInfo:null,mobile24kPath:"",apiUrl:"",init:function(){this.setVisitStore(),this.setClientGroupAuth(),this.setAdvertisement(),this.setEvent(),studioMbPop.load(this.userInfo,this.options,{onShow:function(){$(".boxcont").height($(window).height()-$(".sroll-box").height()-$("#header").height()-$(".cen-ulist").height()-$(".fob_open").height())},onHide:function(){$(".boxcont").height("auto")},onWelcome:function(t){var e=$(".videoroom-ul .tit b:contains('专场')");if(1==e.size()){var n=e.siblings("span[aw]").attr("aw"),o=e.text();common.containSplitStr(n,t)&&alert("您已具备进入“"+o+"”的条件，请关注"+o+"的课程安排。")}}}),this.initRoom()},initRoom:function(){this.userInfo.nickname||this.refreshNickname(!1,"匿名_"+this.userInfo.userId.substring(8,12)),"visitor"==this.userInfo.clientGroup&&this.options.preReg&&studioMbPop.popBox("reg",{groupId:"",clientStoreId:studioChatMbIdx.userInfo.clientStoreId,platform:studioChatMbIdx.options.platform})},checkClientGroup:function(t){var e=studioChatMbIdx.userInfo.clientGroup,n=!1;switch(t){case"visitor":n="visitor"==e;break;case"vip":n="vip"==e||"active"==e;break;case"new":n="vip"!=e&&"active"!=e}return n},refreshNickname:function(t,e){this.userInfo.isSetName=t,this.userInfo.nickname=e,$("#header_ui").text(e),studioMbPop.Person.refreshNickname(e)},setVisitStore:function(){if(!store.enabled)return void console.log("Local storage is not supported by your browser.");var t="storeInfo_"+this.userInfo.groupType,e=store.get(t),n={};if(common.isBlank(e)){var o=common.randomNumber(6);n.clientStoreId=(new Date).getTime()+"_"+o,n.userId="visitor_"+o,n.nickname="游客_"+o,n.userType=-1,store.set(t,n),"wechat"!=this.options.platform&&$(".collect-tip").fadeIn().delay(6e4).fadeOut()}else n=e;this.userInfo.clientStoreId=n.clientStoreId,this.userInfo.visitorId=n.userId,this.userInfo.loginId=n.loginId,this.userInfo.clientGroup&&"visitor"==this.userInfo.clientGroup?(this.userInfo.nickname=n.nickname,this.userInfo.userId=n.userId,$("#contentText").attr("contenteditable",!1).append('<span style="margin:15px 5px;">亲，<a href="javascript:;" onclick="studioChat.openLoginBox();" style="text-decoration: underline;color:#3F51B5;cursor: pointer;">登录</a>&nbsp;&nbsp;后可以发言哦~</span>')):(n.loginId=this.userInfo.userId,store.set(t,n),$("#contentText").html("").attr("contenteditable",!0)),this.isNeverLogin=!common.isValid(n.loginId)},setClientGroupAuth:function(){var t=function(t){t=t||"",t=","+t;var e=[],n=0;return t.indexOf(",vip")>=0&&(e.push("VIP"),n++),t.indexOf(",active")>=0&&t.indexOf(",notActive")>=0?(e.push("真实"),n+=2):t.indexOf(",active")>=0?(e.push("已激活"),n++):t.indexOf(",notActive")>=0&&(e.push("未激活"),n++),t.indexOf(",simulate")>=0&&(e.push("模拟"),n++),t.indexOf(",register")>=0&&(e.push("注册"),n++),t.indexOf(",visitor")>=0&&(e.push("游客"),n++),6==n?"所有客户均可观看":e.join(",")+"用户可观看"};$("#studioListTab .tit span[aw]").each(function(){$(this).html(t($(this).attr("aw")))})},setAdvertisement:function(){this.getArticleList("advertisement","studio_home","0",1,5,'{"sequence":"desc","publishStartDate":"desc"}',function(t){if(0==t.result){var e=t.data;for(var n in e)$("#slider ul").append('<li class="swiper-slide"><a href="'+(common.isBlank(e[n].linkUrl)?"javascript:":e[n].linkUrl)+"\" onclick=\"_gaq.push(['_trackEvent', 'm_studio', 'banner_img', '"+e[n].detailList[0].title+'\']);"  target="_blank"><img width="100%" alt="" src="'+e[n].mediaUrl+'"></a></li>'),e.length>1&&$("#position").append('<span class="'+(0==parseInt(n)?"p-click":"")+'"></span>');e&&e.length>1&&new Swiper(".scroll-imbd",{pagination:".dot-infobox",paginationClickable:!0,loop:!0,autoplay:5e3,autoplayDisableOnInteraction:!1})}})},setBulletin:function(){studioMbPop.loadingBlock($("#bulletinTab")),studioChatMbIdx.getArticleList("bulletin_system","studio_home",1,1,1,'{"sequence":"desc","publishStartDate":"desc"}',function(t){var e=$("#bulletinTab .notice_cont");if(e.html(""),t&&0==t.result){var n=t.data;n&&n.length>0&&e.html(n[0].detailList[0].content)}studioMbPop.loadingBlock($("#bulletinTab"),!0)})},setEvent:function(){this.setEventHeader(),this.setEventCen(),this.setEventRoom(),this.setEventSyllabus(),$(".c_close").click(function(){$(".collect-tip").hide()})},setEventHeader:function(){$("#header_ui").bind("click",function(){studioChatMbIdx.userInfo&&studioChatMbIdx.userInfo.isLogin?studioMbPop.popBox("person"):studioMbPop.popBox("login",{groupId:"",clientGroup:studioChatMbIdx.userInfo.clientGroup,clientStoreId:studioChatMbIdx.userInfo.clientStoreId,platform:studioChatMbIdx.options.platform})})},setEventCen:function(){var t=new Swiper(".cen-qhbox",{loop:!1,autoplay:!1,onSlideChangeStart:function(t){$(".cen-ulist li").eq(t.activeIndex).trigger("click")}});$(".cen-ulist li").bind("click",t,function(t){$(".cen-ulist li.on").removeClass("on"),$(this).addClass("on");var e=$(this).attr("t");"bulletinTab"==e?studioChatMbIdx.setBulletin():"tradeInfoTab"==e?(_gaq.push(["_trackEvent","m_studio","tradstrategy_tab","content_middle",1,!0]),studioChatMbIdx.setNewsInfo("#tradeInfoTab .boxcont",!1,3,5)):"commentTab"==e&&(_gaq.push(["_trackEvent","m_studio","comment_tab","content_middle",1,!0]),studioChatMbIdx.setNewsInfo("#commentTab .boxcont",!1,3,3)),t.data.slideTo($(this).index(),300,!1)}),$("#tradeInfoTab .moreitem").bind("click",function(){_gaq.push(["_trackEvent","m_studio","tradstrategy_more","content_middle",1,!0]),studioChatMbIdx.setNewsInfo("#tradeInfoTab .boxcont",!0,3,5)}),$("#commentTab .moreitem").bind("click",function(){_gaq.push(["_trackEvent","m_studio","comment_more","content_middle",1,!0]),studioChatMbIdx.setNewsInfo("#commentTab .boxcont",!0,3,3)})},setEventRoom:function(){$(".videoroom-ul li").click(function(){$(".videoroom-ul li.on").removeClass("on"),$(this).addClass("on")}),$("#studioListTab .videoroom-ul li:first").trigger("click");var t=$("#studioListTab .videoroom-ul>li");1==t.size()&&t.find(".syllabus").show(),$(".btns .enter").click(function(){var t=$(this).parents("li"),e=t.attr("gi");return"true"!=t.attr("ga")?("visitor"==studioChatMbIdx.userInfo.clientGroup?studioMbPop.popBox("login",{groupId:e,clientGroup:studioChatMbIdx.userInfo.clientGroup,clientStoreId:studioChatMbIdx.userInfo.clientStoreId,platform:studioChatMbIdx.options.platform}):studioChatMbIdx.checkClientGroup("vip")?studioMbPop.showMessage("该房间仅对新客户开放。"):studioMbPop.showMessage("已有真实账户并激活的客户方可进入【特别专场】，您还不满足条件。"),!1):"true"!=t.attr("go")?(studioMbPop.showMessage("该直播间暂未开放，请稍后访问！"),!1):(studioMbPop.loadingBlock($("body")),common.getJson("/studio/checkGroupAuth",{groupId:e},function(t){studioMbPop.loadingBlock($("body"),!0),t.isOK?studioMbPop.reload():t.error&&"1000"===t.error.errcode?studioMbPop.showMessage("您长时间未操作，请刷新页面后重试！"):studioChat.checkClientGroup("vip")?studioMbPop.showMessage("该房间仅对新客户开放。"):studioMbPop.showMessage("已有真实账户并激活的客户方可进入【特别专场】，您还不满足条件。")},!0,function(t){"success"!=t&&(studioMbPop.loadingBlock($("body"),!0),studioMbPop.showMessage("操作失败，请联系客服！"))}),!1)})},setEventSyllabus:function(){var t=$("#studioListTab .videoroom-ul li").map(function(){return $(this).attr("gi")}).get().join(",");$.getJSON("/studio/getSyllabus?t="+(new Date).getTime(),{groupType:studioChatMbIdx.userInfo.groupType,groupId:t},function(t){var e=null,n=t.data;if(n){n instanceof Array||(n=[n]);var o=null,i=null,s=null,r=["周日","周一","周二","周三","周四","周五","周六"],a={0:"文字直播",1:"视频直播",2:"ONE TV"};for(var u in n)if(o=n[u],o.courses){e=common.formatSyllabus(o.courses,t.serverTime,3,{dayCN:r,courseType:a}),i=$("#studioListTab .videoroom-ul li[gi="+o.groupId+"]"),s=common.getSyllabusPlan(o,t.serverTime),s&&(i.find(".syll-tip .syll-time").text(r[s.day+""]+" "+s.startTime+"-"+s.endTime).next().text(a[s.courseType]).next().text(s.lecturer),s.isNext?i.find(".tit div").removeClass("st"):i.find(".tit div").addClass("st"),i.find(".syll-tip").show());var l=i.find(".timetable");l.html(e),l.find("th").bind("click",function(){var t=$(this);t.siblings(".active").removeClass("active"),t.addClass("active");var e=t.attr("d");t.parent().siblings("tr[d]").hide(),t.parent().siblings("tr[d='"+e+"']").show()}),l.find("th.active").trigger("click")}}}),$(".btns .timebtn").click(function(){var t=$(this).parents("li:first").attr("gi");return _gaq.push(["_trackEvent","m_studio","schedule_"+t,"content_middle",1,!0]),$(".pop-time .sc_cont").empty().append($(this).parents("li").find(".timetable").clone(!0)),studioMbPop.popShow($(".pop-time")),!1})},getArticleList:function(t,e,n,o,i,s,r){try{$.getJSON("/studio/getArticleList",{code:t,platform:e,hasContent:n,pageNo:o,pageSize:i,orderByStr:s},function(t){r(t)})}catch(a){console.error("getArticleList->"+a),r(null)}},setNewsInfo:function(t,e,n,o,i){var s=$(t),r=s.find(".moreitem"),a=e?parseInt(r.attr("pno")||1):1;return 0>a?!1:(studioMbPop.loadingBlock(s),void this.getNewsInfoList(n,o,a,i,function(t){var n;if(t&&0==(n=t.informations).result){var i,u=n.informationList,l=null,c=[],d=5==o?"tradstrategy_":"comment_";if(u&&u.length>0){c.push('<ul class="trade-ul">');for(var p in u)l=u[p],i=e?"":" onclick=\"_gaq.push(['_trackEvent', 'm_studio', '"+d+p+"', 'content_middle',1,true]);\"",c.push("<li><a"+i+' href="'+studioChatMbIdx.mobile24kPath+"/comment/"+l.id+"_"+l.contenttype2+'.html" target="_blank">'),c.push("<span>"+l.title+"</span>"),c.push("<time>"+(l.datestr?l.datestr.replace(/(^\d{4}-)|(:\d{2}$)/g,""):"")+"</time>"),c.push("</a></li>");c.push("</ul>")}e||s.find("ul").remove(),r.before(c.join("")),n.totalPage>n.pageNo?r.html("更多"+(5==o?"交易策略":"专业评论")).attr("pno",a+1):r.html("已加载全部"+(5==o?"交易策略":"专业评论")).attr("pno",-1)}else console.error("提取数据有误！");studioMbPop.loadingBlock(s,!0)}))},getNewsInfoList:function(t,e,n,o,i){try{var s=n||1,r=o||5;$.getJSON(this.apiUrl+"/common/getNewsInfoList",{pageNo:s,pageSize:r,lang:"zh",contentType1:t,contentType2:e},function(t){i(t)})}catch(a){console.error("getNewsInfoList->"+a),i(null)}}};