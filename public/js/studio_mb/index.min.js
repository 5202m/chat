var studioChatMbIdx={userInfo:null,mobile24kPath:"",apiUrl:"",init:function(){this.setVisitStore(),this.setClientGroupAuth(),this.setAdvertisement(),this.setEvent(),studioMbPop.load(this.userInfo,{onShow:function(){$(".boxcont").height($(window).height()-$(".sroll-box").height()-$("#header").height()-$(".cen-ulist").height()-$(".fob_open").height())},onHide:function(){$(".boxcont").height("auto")}})},setVisitStore:function(){if(!store.enabled)return void console.log("Local storage is not supported by your browser.");var t="storeInfo_"+this.userInfo.groupType,e=store.get(t),o={};if(common.isBlank(e)){var i=common.randomNumber(6);o.clientStoreId=(new Date).getTime()+"_"+i,o.userId="visitor_"+i,o.nickname="游客_"+i,o.userType=-1,store.set(t,o),$(".collect-tip").fadeIn().delay(6e4).fadeOut()}else o=e;this.userInfo.clientStoreId=o.clientStoreId,this.userInfo.visitorId=o.userId,this.userInfo.clientGroup&&"visitor"==this.userInfo.clientGroup&&(this.userInfo.nickname=o.nickname,this.userInfo.userId=o.userId)},setClientGroupAuth:function(){var t=function(t){t=t||"",t=","+t;var e=[];return t.indexOf(",vip")>=0&&e.push("VIP"),t.indexOf(",real")>=0&&e.push("真实"),t.indexOf(",simulate")>=0&&e.push("模拟"),t.indexOf(",register")>=0&&e.push("注册"),t.indexOf(",visitor")>=0&&e.push("游客"),5==e.length?"所有客户均可观看":e.join(",")+"用户可观看"};$("#studioListTab .tit span").each(function(){$(this).html(t($(this).attr("aw")))})},setAdvertisement:function(){this.getArticleList("advertisement","studio_home","0",1,3,'{"sequence":"asc"}',function(t){if(0==t.result){var e=t.data;for(var o in e)$("#slider ul").append('<li class="swiper-slide"><a href="'+(common.isBlank(e[o].linkUrl)?"javascript:":e[o].linkUrl)+'" target="_blank"><img width="100%" alt="" src="'+e[o].mediaUrl+'"></a></li>'),e.length>1&&$("#position").append('<span class="'+(0==parseInt(o)?"p-click":"")+'"></span>');e&&e.length>1&&new Swiper(".scroll-imbd",{pagination:".dot-infobox",paginationClickable:!0,loop:!0,autoplay:5e3,autoplayDisableOnInteraction:!1})}})},setEvent:function(){this.setEventHeader(),this.setEventCen(),this.setEventRoom(),this.setEventSyllabus(),$(".c_close").click(function(){$(".collect-tip").hide()})},setEventHeader:function(){$("#header_ui").bind("click",function(){studioChatMbIdx.userInfo&&studioChatMbIdx.userInfo.isLogin?studioMbPop.popBox("person"):studioMbPop.popBox("login",{groupId:"",clientStoreId:studioChatMbIdx.userInfo.clientStoreId})})},setEventCen:function(){var t=new Swiper(".cen-qhbox",{loop:!1,autoplay:!1,onSlideChangeStart:function(t){$(".cen-ulist li").eq(t.activeIndex).trigger("click")}});$(".cen-ulist li").bind("click",t,function(t){$(".cen-ulist li.on").removeClass("on"),$(this).addClass("on");var e=$(this).attr("t");"tradeInfoTab"==e?studioChatMbIdx.setNewsInfo("#tradeInfoTab .boxcont",!1,3,5):"commentTab"==e&&studioChatMbIdx.setNewsInfo("#commentTab .boxcont",!1,3,3),t.data.slideTo($(this).index(),300,!1)}),$("#tradeInfoTab .moreitem").bind("click",function(){studioChatMbIdx.setNewsInfo("#tradeInfoTab .boxcont",!0,3,5)}),$("#commentTab .moreitem").bind("click",function(){studioChatMbIdx.setNewsInfo("#commentTab .boxcont",!0,3,3)})},setEventRoom:function(){$(".videoroom-ul li").click(function(){$(".videoroom-ul li.on").removeClass("on"),$(this).addClass("on")}),$("#studioListTab .videoroom-ul li:first").trigger("click");var t=$("#studioListTab .videoroom-ul>li");1==t.size()&&t.find(".syllabus").show(),$(".btns .enter").click(function(){var t=$(this).parents("li");if("true"!=t.attr("ga"))return studioMbPop.showMessage("您没有访问该直播间的权限，如需进入请升级直播间等级或联系客服！"),!1;if("true"!=t.attr("go"))return studioMbPop.showMessage("该直播间暂未开放，请稍后访问！"),!1;studioMbPop.loadingBlock($("body"));var e=t.attr("gi");return common.getJson("/studio/checkGroupAuth",{groupId:e},function(t){studioMbPop.loadingBlock($("body"),!0),t.isOK?studioMbPop.reload():t.error&&"1000"===t.error.errcode?studioMbPop.showMessage("您长时间未操作，请刷新页面后重试！"):studioMbPop.showMessage("您没有访问该直播间的权限，如需进入请升级直播间等级或联系客服！")},!0,function(t){"success"!=t&&(studioMbPop.loadingBlock($("body"),!0),studioMbPop.showMessage("操作失败，请联系客服！"))}),!1})},setEventSyllabus:function(){var t=$("#studioListTab .videoroom-ul li").map(function(){return $(this).attr("gi")}).get().join(",");$.getJSON("/studio/getSyllabus?t="+(new Date).getTime(),{groupType:studioChatMbIdx.userInfo.groupType,groupId:t},function(t){var e=null,o=t.data;if(o){var i=null;console.log("data:",o);for(var n in o)if(i=o[n],i.courses){e=common.formatSyllabus(i.courses,t.serverTime,3,{dayCN:["周日","周一","周二","周三","周四","周五","周六"]});var s=$("#studioListTab .videoroom-ul li[gi="+i.groupId+"]").find(".timetable");s.html(e),s.find("th").bind("click",function(){var t=$(this);t.siblings(".active").removeClass("active"),t.addClass("active");var e=t.attr("d");t.parent().siblings("tr[d]").hide(),t.parent().siblings("tr[d='"+e+"']").show()}),s.find("th.active").trigger("click")}}}),$(".btns .timebtn").click(function(){return $(".pop-time .sc_cont").empty().append($(this).parents("li").find(".timetable").clone(!0)),studioMbPop.popShow($(".pop-time")),!1})},getArticleList:function(t,e,o,i,n,s,r){try{$.getJSON("/wechat/getArticleList",{code:t,platform:e,hasContent:o,pageNo:i,pageSize:n,orderByStr:s},function(t){r(t)})}catch(a){console.error("getArticleList->"+a),r(null)}},setNewsInfo:function(t,e,o,i,n){var s=$(t),r=s.find(".moreitem"),a=e?parseInt(r.attr("pno")||1):1;return 0>a?!1:(studioMbPop.loadingBlock(s),void this.getNewsInfoList(o,i,a,n,function(t){var o;if(t&&0==(o=t.informations).result){var n=o.informationList,l=null,u=[];if(n&&n.length>0){u.push('<ul class="trade-ul">');for(var d in n)l=n[d],u.push('<li><a href="'+studioChatMbIdx.mobile24kPath+"/comment/"+l.id+"_"+l.contenttype2+'.html" target="_blank">'),u.push("<span>"+l.title+"</span>"),u.push("<time>"+(l.datestr?l.datestr.replace(/(^\d{4}-)|(:\d{2}$)/g,""):"")+"</time>"),u.push("</a></li>");u.push("</ul>")}e||s.find("ul").remove(),r.before(u.join("")),o.totalPage>o.pageNo?r.html("更多"+(5==i?"交易策略":"专业评论")).attr("pno",a+1):r.html("已加载全部"+(5==i?"交易策略":"专业评论")).attr("pno",-1)}else console.error("提取数据有误！");studioMbPop.loadingBlock(s,!0)}))},getNewsInfoList:function(t,e,o,i,n){try{var s=o||1,r=i||5;$.getJSON(this.apiUrl+"/getNewsInfoList",{pageNo:s,pageSize:r,lang:"zh",contentType1:t,contentType2:e},function(t){n(t)})}catch(a){console.error("getNewsInfoList->"+a),n(null)}}};